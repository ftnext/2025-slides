:ogp_title: AIã«Pythonã‚’ç†è§£ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ã›ã‚‹è©¦è¡ŒéŒ¯èª¤
:ogp_event_name: wingarc-yumemi-ai
:ogp_slide_name: claude-understand-python
:ogp_description: AIã‚’â€œç›¸æ£’â€ã«ã™ã‚‹ãŸã‚ã®å‹‰å¼·ä¼š
:ogp_image_name: wingarc-yumemi-ai

======================================================================
AIã«Pythonã‚’ç†è§£ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ã›ã‚‹è©¦è¡ŒéŒ¯èª¤
======================================================================

:Event: AIã‚’â€œç›¸æ£’â€ã«ã™ã‚‹ãŸã‚ã®å‹‰å¼·ä¼š
:Presented: 2025/10/29 nikkie

ãŠå‰ã€èª°ã‚ˆ
======================================================================

* nikkieï¼ˆã«ã£ããƒ¼ï¼‰ãƒ»Pythonä½¿ã„
* :fab:`github` `@ftnext <https://github.com/ftnext>`__ ç§ãŒæ¬²ã—ã„å°ã•ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãŠã™ãåˆ†ã‘ã§OSSï¼ˆ`llm-claude-code <https://github.com/ftnext/llm-claude-code>`__ï¼‰
* æ©Ÿæ¢°å­¦ç¿’ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€‚ `Speeda AI Agent <https://www.uzabase.com/jp/info/20250901/>`__ é–‹ç™ºï¼ˆ`We're hiring! <https://hrmos.co/pages/uzabase/jobs/1829077236709650481>`__ï¼‰ [#ai_agent_meetup]_

.. image:: ../_static/uzabase-white-logo.png

.. [#ai_agent_meetup] ä»Šé€±æœ«31æ—¥(é‡‘)å¤œã«ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å‹‰å¼·ä¼šã‚„ã‚Šã¾ã™ï¼`UB Tech vol.21 AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã£ã¦ä½•ã‹ã‚‰å§‹ã‚ã‚‹ï¼Ÿã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã‚ˆã‚‹æŒ‘æˆ¦ <https://connpass.com/event/370935/>`__

.. _ã‚µãƒ ãƒ»ã‚¢ãƒ«ãƒˆãƒãƒ³: https://publishing.newspicks.com/books/9784910063447

å®£ä¼ï¼šæ›¸ç±ã€`ã‚µãƒ ãƒ»ã‚¢ãƒ«ãƒˆãƒãƒ³`_ã€ã€ã„ã‹ãŒã§ã™ã‹ï¼Ÿ
------------------------------------------------------------

.. image:: ../_static/sama-book.jpg
    :width: 80%

ä»Šå›ã¯ Claude Code ã®è©±
======================================================================

Codex CLI ã«ã‚´ãƒªã‚´ãƒªOSSã®ã‚½ãƒ¼ã‚¹èª­ã¾ã›ã‚‚ã—ã¦ã„ã¾ã™ï¼ˆDeepWikiã®ä»£ã‚ã‚Šã«ï¼‰

.. revealjs-break::
    :notitle:

.. raw:: html

    <blockquote class="twitter-tweet" data-lang="ja" data-align="center" data-dnt="true"><p lang="ja" dir="ltr">è¨€èªã‚’å°‘ã—æ·±ãçŸ¥ã£ã¦ã‚‹é–‹ç™ºè€…ãªã‚‰ã€ã„ã¾ã®AIã‚ˆã‚Šã¯è‡ªåˆ†ã®ã»ã†ãŒï¼ˆé€Ÿãã¯ãªã„ã‘ã©ï¼‰è©³ã—ã„ã£ã¦æ„Ÿè¦šãªã‚“ã§ã™ã‹ã­ã‡ <a href="https://twitter.com/hashtag/kichijojipm?src=hash&amp;ref_src=twsrc%5Etfw">#kichijojipm</a><br>ç§ã«ã¨ã£ã¦ã¯PythonãŒãã†ã§ã€Claude CodeãŒæ›¸ã„ã¦ãã‚‹ã‚³ãƒ¼ãƒ‰ã€Pythonã‚’ç†è§£ã—ã¦ãªã„ã®ã§ã€ãƒªãƒ³ã‚¿ãŒæ€’ã‚‹ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’ã„ã¤ã‚‚æ›¸ãã‚“ã§ã™ã‚ˆã­ï¼ˆãƒªãƒ³ã‚¿ã‚’è¨­å®šã—ã¦æ¸¡ã•ãªãã‚ƒ</p>&mdash; nikkie(ã«ã£ããƒ¼) / ã«ã£P (@ftnext) <a href="https://twitter.com/ftnext/status/1964228096263094311?ref_src=twsrc%5Etfw">September 6, 2025</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

ã‚ãªãŸ Python åˆ†ã‹ã£ã¦ã¾ã™ï¼Ÿ
---------------------------------------------------

* Claudeã¯äººé¡ã«æ¯”ã¹ã¦é€Ÿãã€å®‰ãPythonã‚’æ›¸ã
* ãŸã ç§ã‹ã‚‰ã¯Pythonã‚’ **ç†è§£ã—ã¦ã„ã‚‹ã¨ã¯è¨€ãˆãªã„**
* Pythonã‚’ç†è§£ã—ã¦ã„ã‚‹ãªã‚‰æ›¸ã‹ãªã„ã‚³ãƒ¼ãƒ‰ã‚’é »ç¹ã«æ›¸ããŸã‚

ä¾‹ï¼šf-string
---------------------------------------------------

* ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«
* **å¼** ã‚’å«ã‚ã‚‰ã‚Œã‚‹

.. code-block:: pycon

    >>> name = "ã‚Šã›"
    >>> f"ã“ã‚“ã«ã¡ã¯ã€{name}ã•ã‚“ï¼"
    'ã“ã‚“ã«ã¡ã¯ã€ã‚Šã›ã•ã‚“ï¼'
    >>> print(f"2 + 3 = {2 + 3}")
    2 + 3 = 5

ãƒ­ã‚®ãƒ³ã‚°ã«f-stringã¯ä½¿ã‚ãªã„ [#fstring_logging_article]_
----------------------------------------------------------------------

.. code-block:: python
    :caption: f-stringã®ä»£ã‚ã‚Šã«%-format

    logger.info("%s - Something happened", user)
    logger.error("Python version: %s", sys.version)

.. [#fstring_logging_article] æ‹™ãƒ–ãƒ­ã‚° `Pythonã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«f-stringã¯ã„ã‘ã¾ã›ã‚“ã€‚ãã“ã®Claudeã€ç§ã¯ã‚ãªãŸã«è¨€ã£ã¦ã„ã‚‹ã‚“ã§ã™ã‚ˆ <https://nikkie-ftnext.hatenablog.com/entry/hey-claude-dont-use-f-string-in-logging-messages>`__

ã—ã‹ã—Claudeã¯å¹³æ°—ã§f-stringã‚’ä½¿ã†
---------------------------------------------------

.. code-block:: python
    :caption: f-stringã§ãƒ­ã‚®ãƒ³ã‚°ã—ã¦ã¯ã„ã‘ã¾ã›ã‚“ [#why_no_fstring_logging]_

    logger.info(f"{user} - Something happened")
    logger.error(f"Python version: {sys.version}")

.. [#why_no_fstring_logging] f-stringã¯ãã®å ´ã§è©•ä¾¡ã•ã‚Œã‚‹ãŸã‚ã§ã™ã€‚%-formatãªã‚‰ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãŒæœ‰åŠ¹ãªã¨ãã®ã¿è©•ä¾¡ã•ã‚Œã¾ã™

ğŸ’¡ãƒªãƒ³ã‚¿ã§æŒ‡æ‘˜ã—ã‚ˆã†
======================================================================

* `logging-f-string (G004) <https://docs.astral.sh/ruff/rules/logging-f-string/>`__
* `flake8-logging-format <https://github.com/globality-corp/flake8-logging-format/tree/0.9.0?tab=readme-ov-file#violations-detected>`__

    ``G004`` Logging statements should not use ``f"..."`` for their first argument

.. _Ruff: https://github.com/astral-sh/ruff

`Ruff`_
---------------------------------------------------

* Rustã§æ›¸ã‹ã‚ŒãŸPythonã®ãƒªãƒ³ã‚¿å…¼ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ã€‚é€Ÿã„ [#ruff_command]_
* flake8ã‚„pylintï¼ˆãƒªãƒ³ã‚¿ï¼‰ãƒ»blackï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ï¼‰ã‹ã‚‰Ruffã¸ã®ç½®ãæ›ãˆãŒé€²ã‚€

.. code-block:: console

    $ uvx ruff check --fix --extend-select I && uvx ruff format

.. [#ruff_command] æ‹™ãƒ–ãƒ­ã‚° `Ruffã¯ format ã¨ check --fix ã®2ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹ (Ruff 0.7.2) <https://nikkie-ftnext.hatenablog.com/entry/ruff-as-python-formatter-two-commands>`__

:command:`hatch fmt`
---------------------------------------------------

* Ruffã®ãƒªãƒ³ãƒˆã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ç¾çŠ¶åˆ¥ã€…ã®ã‚³ãƒãƒ³ãƒ‰
* Pythonãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ« `Hatch <https://github.com/pypa/hatch>`__ ã¯ã€Ruffã®ãƒªãƒ³ãƒˆã¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’1ã‚³ãƒãƒ³ãƒ‰ã§æµã›ã‚‹ [#hatch_fmt_reference]_
* æ™®é€šã«Ruffã‚’æµã™ã‚ˆã‚Šã‚‚ **å³ã—ã„ãƒ«ãƒ¼ãƒ«**

.. [#hatch_fmt_reference] https://hatch.pypa.io/latest/cli/reference/#hatch-fmt

Claude Codeã® **ãƒ•ãƒƒã‚¯** ã‚’è¨­å®š
======================================================================

* Pythonã‚’æ›¸ã„ãŸã¨ãã« ``hatch fmt`` ã‚’å®Ÿè¡Œã™ã‚‹
* ``hatch fmt`` ã®å‡ºåŠ›ã‚’ç¹°ã‚Šè¿”ã—Claudeã«è¦‹ã›ã‚‹ï¼ˆé€ƒ ã— ã¾ ã› ã‚“ï¼‰

ãƒ­ãƒ¼ã‚«ãƒ«ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¨­å®š
---------------------------------------------------

.. code-block:: text

    .claude/
    â”œâ”€â”€ hooks/
    â”‚   â””â”€â”€ python_format.sh
    â””â”€â”€ settings.local.json

PostToolUseãƒ•ãƒƒã‚¯
---------------------------------------------------

Editã¾ãŸã¯Writeã§Pythonãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ã„ãŸã‚‰

.. literalinclude:: ../../samplecode/claude-code-harness/.claude/settings.local.json
    :language: json

:file:`python_format.sh`
---------------------------------------------------

.. literalinclude:: ../../samplecode/claude-code-harness/.claude/hooks/python_format_v0.sh
    :language: bash

ãƒ•ãƒƒã‚¯ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Claudeã«è¦‹ã›ã‚‹ãŸã‚ã«
---------------------------------------------------

* :file:`python_format.sh` ã®çµ‚äº†ã‚³ãƒ¼ãƒ‰ã‚’ **2** ã«ã™ã‚‹ï¼ˆClaude Codeã‚’ãƒ–ãƒ­ãƒƒã‚¯ï¼‰
* ``hatch fmt`` ã®å‡ºåŠ›ã‚’ **stderr** ã¸ï¼ˆClaudeãŒè¦‹ã‚‹ï¼‰

ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã®ã€Œ`Hookå‡ºåŠ› <https://docs.claude.com/ja/docs/claude-code/hooks#hook%E5%87%BA%E5%8A%9B>`__ã€å‚ç…§ [#claude_code_hook_article]_

.. [#claude_code_hook_article] æ‹™ãƒ–ãƒ­ã‚° `ãƒ•ãƒƒã‚¯ã§ãƒªãƒ³ã‚¿ï¼ˆhatch fmtï¼‰ã®ã‚¨ãƒ©ãƒ¼ã‚’ Claude Code ã«è¦‹ã›ã¦ã€Python ã‚’ç†è§£ã—ã¦ã„ã‚‹å®Ÿè£…ã‚’ã•ã›ã‚‹ <https://nikkie-ftnext.hatenablog.com/entry/claude-code-hooks-run-hatch-fmt-good-python-code>`__

ãƒ‡ãƒ¢
======================================================================

    ã‚¨ãƒ©ãƒˆã‚¹ãƒ†ãƒã‚¹ã®ç¯©ã‚’Pythonã§æ›¸ã„ã¦

.. revealjs-break::
    :notitle:

.. code-block:: console

    â¿ PostToolUse:Write hook returned blocking error: [jq -r 
        '.tool_input.file_path' | { read file_path; if echo "$file_path"
        | grep -q '\.py$'; then 
        "$CLAUDE_PROJECT_DIR"/.claude/hooks/python_format.sh 
        "$file_path"; fi; }]: cmd [1] | ruff check --config 
        '/.../hatch/env/.internal/
        hatch-static-analysis/.config/ukmfGEkg/ruff_defaults.toml' --fix
        /.../claude-code-harness
        /sieve_of_eratosthenes.py
        sieve_of_eratosthenes.py:11:12: PLR2004 Magic value used in 
        comparison, consider replacing `2` with a constant variable
        sieve_of_eratosthenes.py:27:12: RET504 Unnecessary assignment to
        `primes` before `return` statement
        sieve_of_eratosthenes.py:35:5: T201 `print` found
        sieve_of_eratosthenes.py:36:5: T201 `print` found
        sieve_of_eratosthenes.py:37:5: T201 `print` found
        Found 5 errors.
        No fixes available (4 hidden fixes can be enabled with the 
        `--unsafe-fixes` option).


    âº Pythonã®lintã‚¨ãƒ©ãƒ¼ãŒ  08:24 PM  claude-sonnet-4-5-20250929
    æ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ä¿®æ­£
    ã—ã¾ã™ã€‚

.. revealjs-break::
    :notitle:

.. code-block:: python
    :caption: å½“æ—¥ç”Ÿæˆã•ã‚ŒãŸ :file:`sieve_of_eratosthenes.py`

    MINIMUM_PRIME = 2


    def sieve_of_eratosthenes(n):
        """
        ã‚¨ãƒ©ãƒˆã‚¹ãƒ†ãƒã‚¹ã®ç¯©ã‚’ä½¿ã£ã¦ã€nä»¥ä¸‹ã®ç´ æ•°ã‚’å…¨ã¦æ±‚ã‚ã‚‹

        Args:
            n: ä¸Šé™å€¤

        Returns:
            nä»¥ä¸‹ã®ç´ æ•°ã®ãƒªã‚¹ãƒˆ
        """
        if n < MINIMUM_PRIME:
            return []

        # æœ€åˆã¯å…¨ã¦ã®æ•°ã‚’ç´ æ•°å€™è£œã¨ã™ã‚‹
        is_prime = [True] * (n + 1)
        is_prime[0] = is_prime[1] = False  # 0ã¨1ã¯ç´ æ•°ã§ã¯ãªã„

        # 2ã‹ã‚‰sqrt(n)ã¾ã§å‡¦ç†
        for i in range(MINIMUM_PRIME, int(n**0.5) + 1):
            if is_prime[i]:
                # iã®å€æ•°ã‚’å…¨ã¦åˆæˆæ•°ã¨ã—ã¦ãƒãƒ¼ã‚¯
                for j in range(i * i, n + 1, i):
                    is_prime[j] = False

        # ç´ æ•°ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦è¿”ã™
        return [i for i in range(n + 1) if is_prime[i]]


    # ä½¿ç”¨ä¾‹
    def main():
        # 100ä»¥ä¸‹ã®ç´ æ•°ã‚’æ±‚ã‚ã‚‹
        n = 100
        primes = sieve_of_eratosthenes(n)
        print(f"{n}ä»¥ä¸‹ã®ç´ æ•°:")  # noqa: T201
        print(primes)  # noqa: T201
        print(f"\nç´ æ•°ã®å€‹æ•°: {len(primes)}")  # noqa: T201


    if __name__ == "__main__":
        main()

æ™‚é–“ãŒã‚ã£ãŸã‚‰è©±ã™ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
======================================================================

* Pythonã§ãƒ•ãƒƒã‚¯ã‚’æ›¸ã
* ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§é…å¸ƒ

1ï¸âƒ£ cchooks
---------------------------------------------------

* https://github.com/GowayLee/cchooks
* `hesreallyhim/awesome-claude-code <https://github.com/hesreallyhim/awesome-claude-code>`__ æ²è¼‰
* Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ãƒ•ãƒƒã‚¯ã‚’æ›¸ã‘ã‚‹ [#cchooks_article]_

.. [#cchooks_article] æ‹™ãƒ–ãƒ­ã‚° `Claude Code ã®ãƒ•ãƒƒã‚¯ã‚’ Python ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ›¸ã‘ã‚‹ cchooks ã§ hatch fmt ã‚’å®Ÿè¡Œã™ã‚‹ãƒ•ãƒƒã‚¯ã‚’æ›¸ã <https://nikkie-ftnext.hatenablog.com/entry/claude-code-hooks-cchooks-first-step-hatch-fmt>`__

inline script metadataã¨å¥‡è·¡çš„ç›¸æ€§ğŸ«¶
---------------------------------------------------

.. code-block:: python

    #!/usr/bin/env -S uv run
    # /// script
    # requires-python = ">=3.11"
    # dependencies = [
    #     "cchooks",
    # ]
    # ///
    import subprocess

    import cchooks

    c = cchooks.create_context()

    if c.tool_input.get("file_path", "").endswith(".py"):
        file_path = c.tool_input["file_path"]
        result = subprocess.run(["uvx", "hatch", "fmt", file_path], capture_output=True, text=True)
        if result.returncode == 1:  # Need to fix formatting
            cchooks.exit_block(f"Fix `hatch fmt` issues:\n{result.stdout}")
        else:
            cchooks.exit_success()

2ï¸âƒ£ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³
---------------------------------------------------

* `Plugins <https://docs.claude.com/en/docs/claude-code/plugins>`__
* https://github.com/ftnext/claude-code ã‚’ä½œã£ãŸ
* ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ãŒã€PostToolUseã®çµ‚äº†ã‚³ãƒ¼ãƒ‰2ã§ *æ­¢ã¾ã£ã¦* ã—ã¾ã†ï¼ˆv2.0.27ã§è¦³æ¸¬ï¼‰

ã¾ã¨ã‚ğŸŒ¯ AIã«Pythonã‚’ç†è§£ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ã›ã‚‹è©¦è¡ŒéŒ¯èª¤
======================================================================

* Claude Codeã€Pythonã‚’ç†è§£ã—ã¦ãªã„ã‚ˆãªã‚
* :command:`hatch fmt` ã‚’PostToolUseãƒ•ãƒƒã‚¯ã«è¨­å®šã—ã¦é€ƒã•ãªã„
* å¼•ãç¶šãç£¨ãè¾¼ã‚“ã§ã„ããï¼ˆã‚³ãƒ¡ãƒ³ãƒˆå¤šã„ã€å‹ãƒã‚§ãƒƒã‚¯ï¼‰

ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ
--------------------------------------------------

Happy AI-assisted developmentğŸ¤–

å®£ä¼ï¼š`10/30(æœ¨)31(é‡‘)AIé§†å‹•é–‹ç™ºã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ <https://aid.connpass.com/event/367697/>`__ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç„¡æ–™ã§ã™ï¼ï¼

.. revealjs-break::
    :notitle:

.. raw:: html

    <blockquote class="twitter-tweet" data-lang="ja" data-align="center" data-dnt="true"><p lang="ja" dir="ltr">å­¦ãƒã‚¹ã®ç§¦è°·ç¾éˆ´ã•ã‚“ãŒè¨€ã£ãŸã¨ã•ã‚Œã‚‹<br>ã€Œã‚ãŸã—ãŒä¸Šã§ã€ã‚ãªãŸãŒä¸‹ã§ã™ã€<a href="https://t.co/tMEWieYG3i">https://t.co/tMEWieYG3i</a><br>ChatGPTã¨ã‹Claudeã‚’ä½¿ã†ã¨ãã®ãƒã‚¤ãƒ³ãƒ‰ã‚»ãƒƒãƒˆã«é€šã˜ã‚‹ã‚‚ã®ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚LLMãŒä¸‹</p>&mdash; nikkie(ã«ã£ããƒ¼) / ã«ã£P (@ftnext) <a href="https://twitter.com/ftnext/status/1949106210122391956?ref_src=twsrc%5Etfw">2025å¹´7æœˆ26æ—¥</a></blockquote>
